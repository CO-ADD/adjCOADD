<!--prettier-ignore-->
{% extends 'base.html'%}
<!--prettier-ignore-->
{% block title%} mysite{% endblock %}
<!--prettier-ignore-->
{% block content%}

<div class="position-relative w-100 bg-transparent">
  <div class="row bg-transparent">
    <h1>Screening data</h1>
  </div>
  <div class="d-flex flex-row bg-light justify-content-between">
    {%include "utils/sidebar.html"%}

    <div class="main d-flex flex-column">
      <div class="d-flex flex-wrap justify-content-between">
        <a href="{%url 'importTaxo'%}" class="btn btn-outline-secondary"><i class="bi bi-cloud-arrow-up"></i>import
          Taxonomy</a>
        <div>

          <a href="{%url 'taxo_list'%}" class="btn btn-outline-secondary"><i class="bi bi-list"></a>
          <a href="{%url 'taxo_card'%}" class="btn btn-outline-secondary"><i class="bi bi-grid-fill"></i></a>
        </div>
      </div>
      <hr>


      {% include 'utils/pagination.html'%}
      <div id="createTaxo">

        <a class="btn m-auto">Create New Taxo
          <i class="bi bi-plus"></i>
        </a>
        <h5>{%include 'utils/message.html'%}</h5>
      </div>

      <div id="createTaxoModal" class="modal fade" role="dialog">
      </div>
      <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
      <script>

        $(document).ready(function () {

          let my_modal = $("#createTaxoModal");

          $("#createTaxo a").click(function () {
            my_modal.load("{%url 'taxo_create'%}", function (response, status, xhr) {
              console.log(typeof (response))
              if (response == "Permission Not Granted") {
                alert("permission!")

              } else {
                my_modal.modal("show"); // Open Modal
              }

            });
          });
        });

      </script>

      <div class="row d-flex flex-wrap">
        {% for taxo in page_obj %}

        <div id="comps-taxo" class="col-md-3">
          <div class="card bg-transparent my-2 compounds">
            <a class="btn btn-sm btn-outline-secondary" href="{%url 'taxo_detail' taxo.Organism_Name%}">Detail</a>
            <p class="lead fs-4 m-auto"> ID: {{taxo.Division}}</p>
            <a href="{%url 'taxonomy_delete' taxo.Organism_Name %}">Delete</a>

            <h5 class="bi bi-tag fw-bold lead fs-4 m-auto"> Name: {{taxo.Organism_Name}}</h5>
            <div id="{{taxo.Organism_Name}}">
              <a class="card-link">Update</a>
            </div>

            <div id="taxoUpdateModal" class="modal fade" role="dialog">
            </div>
            <script>

              $(document).ready(function () {

                btn = "#" + "{{taxo.Organism_Name}}"
                let my_modal = $('#taxoUpdateModal');

                console.log(btn)
                $(`${btn} a`).click(function () {

                  my_modal.load("{% url 'taxonomy_update' taxo.Organism_Name %}", function (response) {
                    if (response == "Permission Not Granted") {
                      alert("permission!")

                    } else {
                      my_modal.modal("show"); // Open Modal
                    }
                  });
                });
              });

            </script>


            <p>
            <div class="text-center" type="button" data-bs-toggle="collapse"
              data-bs-target="#collapse{{taxo.Organism_Name}}" aria-expanded="false"
              aria-controls="{{taxo.Organism_Name}}">
              <i class="bi bi-chevron-bar-down"></i><i class="bi bi-chevron-bar-up"></i>
            </div>

            </p>
            <div class="collapse" id="collapse{{taxo.Organism_Name}}">

              <div class="card-body d-flex flex-column align-items-start">

                <p class="lead fs-5 text-dark">Tax_ID: {{taxo.Tax_ID}}}</p>
                <p class="fw-bold lead fs-5 text-success">
                  {{taxo.Lineage}}

                  {%for item in taxo.Lineage%}
                  <li>{{item}}</li>
                  {%endfor%}
                </p>

                <p>Division_CODE:
                  {{taxo.Division_CODE}}
                </p>
                <ul>
                  <li>
                    {{taxo.Other_Names}}
                  </li>
                  <li>
                    {{taxo.Division}}
                  </li>
                  <li>
                    {{taxo.Class}}
                  </li>

                  <li>
                    {{taxo.Tax_Rank}}
                  </li>
                  <li>
                    {{taxo.Division}}
                  </li>
                </ul>
                <!--prettier-ignore-->

              </div>
            </div>
          </div>

          <!-- ------------------------------------------------------------------------------------------------------- -->

          <!-- ------------------------------------------------------------------------------------------------------------------------------- -->
        </div>
        {%endfor%}


      </div>
      <hr>
      {% include 'utils/pagination.html'%}


    </div>
    <script>
      $(document).ready(() => {
        console.log("loading document")
        $('a.switch').click(function () {
          var url = this.href + '?' + window.location.href.split('?')[1];
          window.location.href = url;
          return false;
        });


      })
    </script>



  </div>
</div>
</div>



<!--prettier-ignore-->
{% endblock%}