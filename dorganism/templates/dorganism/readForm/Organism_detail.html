<!--prettier-ignore-->
{% extends 'base.html'%}
<!--prettier-ignore-->
{% block title%} mysite{% endblock %}
<!--prettier-ignore-->
{% block content%}
<div class=" mx-2 border border-2">


    <p class="m-atuo">

    <div id="{{object.pk}}">
        <a class="btn btn-success btn-sm">Update with Organism Name</a>
    </div>

    <div id="OrganismUpdateModal" class="modal fade " role="dialog">
    </div>

    <script>
        // document.formHasErrors = {% if form.errors %}true{% else %} false{% endif %};

        $(document).ready(function () {
            btn = "#" + "{{object.pk}}"
            let my_modal = $('#OrganismUpdateModal');
            $(`${btn} a`).click(function () {
                my_modal.load("{% url 'organism_update' object.pk %}", function (response) {
                    if (response == "Permission Not Granted") {
                        alert("permission!")

                    } else {
                        my_modal.modal("show"); // Open Modal
                    }
                });
            });


            if (document.formHasErrors) {
                my_modal.modal('show');
            }


        });

    </script>
    {% if form_error %}
    <script>
        $(document).ready(function () {

            let my_modal = $('#OrganismUpdateModal');
            my_modal.modal("show");
        })
    </script>
    {% endif %}
    </p>

    <p>
        <a class="btn btn-success btn-sm" data-bs-toggle="collapse" href="#collapseExample" role="button"
            aria-expanded="false" aria-controls="collapseExample">
            collapse window
        </a>

    </p>
    <div class="collapse show" id="collapseExample">
        <div class="card card-body" style="width: 80rem ;">
            <h4 class="my-0">Organism: {{object.organism_name}}</h4>
            <h5>Class: {{object.organism_name.org_class.dict_value}}</h5>
            <!-- <p>{{Organism_Name}}</p> -->

            {% if messages %}
            <ul class="messages">
                {% for message in messages %}
                <li{% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
                    {% endfor %}
            </ul>
            {% endif %}
            <!-- ===================================================================================== -->
            <hr>
            <b>
                {%include 'utils/message.html'%}
            </b>
            <form id="OrganismUpdateForm" method="POST" action="{%url 'organism_update' object.pk %}">
                {% csrf_token %}
                <!-- {{form.as_table}} -->
                <div class="d-flex m-auto">
                    <a href="{% url 'organism_delete' object.pk %}">Delete</a>
                    <a class="btn m-auto mt-5" href="{% url 'org_detail' object.pk %}">cancel</a>
                    <input type="submit" class="btn m-auto mt-5" value="Updated" name="note" />

                </div>
                <div class="row">

                    <div class="col-md-4 ">

                        <table class="table table-bordered table-responsive-sm m-2">


                            <tbody>
                                <tr>
                                    <th scope="row" class="table-light"> Name</th>
                                    <td><a
                                            href="{%url 'taxo_detail' object.organism_name %}">{{object.organism_name}}</a>
                                    </td>

                                </tr>

                                <tr>
                                    <th scope="row" class="table-light">
                                        <label for="id_risk_group">Risk Group</label>
                                    </th>
                                    <td class="editablechoices tdclass" data-id="{{object.pk}}" data-type="risk_group">
                                        <div class="detail">
                                            {{object.risk_group}}
                                        </div>
                                        <div class="form-control select"> {{form.risk_group}}</div>

                                    </td>

                                </tr>

                                <tr>
                                    <th scope="row" class="table-light">Pathogen</th>
                                    <td class="editablechoices tdclass" data-id="{{object.pk}}"
                                        data-type="pathogen_group">
                                        <div class="detail">
                                            {{object.pathogen_group}}
                                        </div>
                                        <div class="form-control select"> {{form.pathogen_group}}</div>

                                    </td>

                                </tr>
                                <!-- <tr>
                                    <th scope="row" class="table-light">Panels (chnage to editable)</th>
                                    <td data-id="{{object.pk}}" data-type="Panels">
                                        {{form.Panels}}</td>

                                </tr> -->
                                <tr>
                                    <th scope="row" class="table-light">Lab Restriction</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="lab_restriction">

                                        <div class="detail">
                                            {{object.lab_restriction}}
                                        </div>
                                        <div class="input-group select">{{form.lab_restriction}}</div>
                                    </td>

                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Biol Approval</th>
                                    <td class="editablechoices tdclass" data-id="{{object.pk}}"
                                        data-type="bio_approval">
                                        <div class="detail">
                                            {{object.bio_approval}}
                                        </div>
                                        <div class="form-control select"> {{form.bio_approval}}</div>


                                    </td>

                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Import Permit</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="import_permit">

                                        <div class="detail">
                                            {{object.import_permit}}
                                        </div>
                                        <div class="input-group select">{{form.import_permit}}</div>
                                    </td>

                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">MTA Document</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="mta_document">

                                        <div class="detail">
                                            {{object.mta_document}}
                                        </div>
                                        <div class="input-group select">{{form.mta_document}}</div>
                                    </td>

                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">MTA Status</th>
                                    <td class="editablechoices tdclass" data-id="{{object.pk}}" data-type="mta_status">

                                        <div class="detail">
                                            {{object.mta_status}}
                                        </div>
                                        <div class="form-control select"> {{form.mta_status}}</div>

                                    </td>

                                </tr>

                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-4">

                        <table class="table table-bordered m-2 table-responsive-sm ">

                            <tbody>

                                <tr>
                                    <td colspan="2" class="table-light">Strain </td>

                                </tr>

                                <tr>
                                    <th scope="row" class="table-light">Strain ID</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="strain_id">

                                        <div class="detail">
                                            {{object.strain_id}}
                                        </div>
                                        <div class="input-group select">{{form.strain_id}}</div>
                                    </td>

                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Strain Code</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="strain_code">

                                        <div class="detail">
                                            {{object.strain_code}}
                                        </div>
                                        <div class="input-group select">{{form.strain_code}}</div>
                                    </td>

                                </tr>

                                <tr>
                                    <th scope="row" class="table-light">Strain Notes</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="strain_notes">

                                        <div class="detail">
                                            {{object.strain_notes}}
                                        </div>
                                        <div class="input-group select">{{form.strain_notes}}</div>

                                    </td>

                                </tr>

                                <tr>
                                    <th scope="row" class="table-light"> Strain_Type</th>
                                    <td class="editablechoices tdclass" data-id="{{object.pk}}" data-type="strain_type">

                                        <div class="detail">
                                            {%for i in object.strain_type%}
                                            <span>i, </span>
                                            {%endfor%}

                                        </div>
                                        <div class="form-control select col-12 fs-6"> {{form.strain_type}}</div>
                                    </td>

                                </tr>
                                <!-- <tr>
                                    <th scope="row" class="table-light">Gen Type (change)</th>
                                    <td data-id="{{object.pk}}" data-type="Gen_Type">{{form.Gen_Type}}
                                    </td>

                                </tr> -->
                                <tr>
                                    <th scope="row" class="table-light">Sequence</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="sequence">
                                        <div class="detail">
                                            {{object.sequence}}
                                        </div>
                                        <div class="input-group select">{{form.sequence}}</div>

                                    </td>

                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Sequence Link</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="sequence_link">
                                        <div class="detail">
                                            {{object.sequence_link}}
                                        </div>
                                        <div class="input-group select">{{form.sequence_link}}</div>

                                    </td>

                                </tr>
                                <!-- <tr>
                                    <th scope="row" class="table-light">Sequence MLST (change)</th>
                                    <td data-id="{{object.pk}}" data-type="Sequence_ML_ST">
                                        {{form.Sequence_ML_ST}}</td>

                                </tr> -->
                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-3">

                        <table class="table table-bordered m-2 table-responsive-sm ">
                            <tbody>
                                <tr>
                                    <th scope="col" colspan="2" class="table-light">Preference</th>
                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Oxygen Pref</th>
                                    <td class="editablechoices tdclass" data-id="{{object.pk}}" data-type="oxygen_pref">

                                        <div class="detail">
                                            {{object.oxygen_pref}}
                                        </div>
                                        <div class="form-control select"> {{form.oxygen_pref}}</div>

                                    </td>

                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Atmosphere Pref</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="atmosphere_pref">
                                        <div class="detail">
                                            {{object.atmosphere_pref}}
                                        </div>
                                        <div class="input-group select">{{form.atmosphere_pref}}</div>

                                    </td>

                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Nutrient Pref</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="nutrient_pref">
                                        <div class="detail">
                                            {{object.nutrient_pref}}
                                        </div>
                                        <div class="input-group select">{{form.nutrient_pref}}</div>
                                    </td>


                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Biofilm Pref</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="biofilm_pref">
                                        <div class="detail">
                                            {{object.biofilm_pref}}
                                        </div>
                                        <div class="input-group select">{{form.biofilm_pref}}</div>
                                    </td>


                                </tr>

                                <tr>
                                    <th scope="row" class="table-light">Biologist (change)</th>
                                    <td class="editablechoices tdclass" data-id="{{object.pk}}" data-type="biologist">
                                        <div class="detail">
                                            {{object.biologist}}
                                        </div>
                                        <div class="form-control select">{{form.biologist}}</div>
                                    </td>


                                </tr>
                                <tr>
                                    <th scope="row" class="table-light">Tax ID</th>
                                    <td class="editable" data-id="{{object.pk}}" data-type="tax_id">

                                        <div class="detail">
                                            {{object.tax_id}}
                                        </div>
                                        <div class="input-group select">{{form.tax_id}}</div>

                                    </td>


                                </tr>

                            </tbody>
                        </table>
                    </div>

                </div>



            </form>

        </div>

    </div>


    <div class="card m-4">

        <div class="card-header">
            Organism Batch
        </div>
        <div class="row">
            <div class="col-md-4 table-responsive-sm">

            </div>
            <div class="col-md-3 table-responsive-sm">

            </div>
        </div>






    </div>



</div>
{% load static %}
<script type="text/javascript" src="{% static 'js/jquery-3.6.1.min.js' %}"></script>
<script src="{% static 'js/editableTable.js' %}" type="text/javascript"></script>
<script src="{% static 'js/editableTablechoices.js' %}" type="text/javascript"></script>
<!-- <script src="{% static 'js/js_utils/getCookie.js' %}" type="text/javascript"></script>
<script src="{% static 'js/js_utils/ajax_update.js' %}" type="text/javascript"></script> -->

{%endblock%}